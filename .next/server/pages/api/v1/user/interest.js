"use strict";(()=>{var e={};e.id=3904,e.ids=[3904],e.modules={8097:e=>{e.exports=require("@sentry/nextjs")},2167:e=>{e.exports=require("axios")},3582:e=>{e.exports=require("cors")},1185:e=>{e.exports=require("mongoose")},1649:e=>{e.exports=require("next-auth/react")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},3160:e=>{e.exports=require("next/dist/lib/import-next-warning")},5828:e=>{e.exports=require("uuid")},6113:e=>{e.exports=require("crypto")},7147:e=>{e.exports=require("fs")},1017:e=>{e.exports=require("path")},8874:(e,t,s)=>{s.r(t),s.d(t,{config:()=>p,default:()=>R,routeModule:()=>E});var r={};s.r(r),s.d(r,{default:()=>c});var a=s(1802),u=s(7153),n=s(6249),i=s(5912),o=s(3300),d=s(5166),l=s(3506);let handler=async(e,t)=>{if(await (0,d.D0)(e,t),"OPTIONS"===e.method){t.status(200).end();return}await (0,l.uD)();let{method:s}=e;switch(s){case"POST":return handleCreateInterest(e,t);case"GET":return handleGetInterests(e,t);case"PATCH":return handleUpdateInterest(e,t);default:return t.status(i.uT.BAD_REQUEST).json((0,d.OF)({status:!1,message:`Method ${e.method} Not Allowed`}))}},handleCreateInterest=async(e,t)=>{try{let{userId:s,eventType:r,eventDescription:a,metadata:u,source:n}=e.body;if(!s||!r||!n)return t.status(i.uT.BAD_REQUEST).json((0,d.OF)({status:!1,message:"Required fields: userId, eventType, source"}));let l=e.headers["x-forwarded-for"]?.toString().split(",")[0]||e.headers["x-real-ip"]?.toString()||e.connection.remoteAddress||"unknown",c=e.headers["user-agent"]||"unknown",{data:R,error:p}=await (0,o.createUserInterestInDB)({userId:s,eventType:r,eventDescription:a,metadata:u,source:n,ipAddress:l,userAgent:c});if(p)return t.status(i.uT.INTERNAL_SERVER_ERROR).json((0,d.OF)({status:!1,message:"Failed to create user interest",error:p}));return t.status(i.uT.RESOURCE_CREATED).json((0,d.OF)({status:!0,data:R,message:"User interest created successfully"}))}catch(e){return console.error("Error creating user interest:",e),t.status(i.uT.INTERNAL_SERVER_ERROR).json((0,d.OF)({status:!1,message:"Failed to create user interest",error:e.message}))}},handleGetInterests=async(e,t)=>{try{let s;let{userId:r,eventType:a,source:u,isActive:n,page:l="1",limit:c="10"}=e.query,R=parseInt(l,10),p=parseInt(c,10);void 0!==n&&(s="string"==typeof n?"true"===n:!!n);let{data:E,error:g}=await (0,o.getUserInterestsFromDB)({userId:r,eventType:a,source:u,isActive:s,page:R,limit:p});if(g)return t.status(i.uT.INTERNAL_SERVER_ERROR).json((0,d.OF)({status:!1,message:"Failed to get user interests",error:g}));return t.status(i.uT.OKAY).json((0,d.OF)({status:!0,data:E,message:"User interests retrieved successfully"}))}catch(e){return console.error("Error getting user interests:",e),t.status(i.uT.INTERNAL_SERVER_ERROR).json((0,d.OF)({status:!1,message:"Failed to get user interests",error:e.message}))}},handleUpdateInterest=async(e,t)=>{try{let{interestId:s,isActive:r}=e.body;if(!s||void 0===r)return t.status(i.uT.BAD_REQUEST).json((0,d.OF)({status:!1,message:"Required fields: interestId, isActive"}));let{data:a,error:u}=await (0,o.updateUserInterestInDB)(s,r);if(u){if("Interest not found"===u)return t.status(i.uT.NOT_FOUND).json((0,d.OF)({status:!1,message:u}));return t.status(i.uT.INTERNAL_SERVER_ERROR).json((0,d.OF)({status:!1,message:"Failed to update user interest",error:u}))}return t.status(i.uT.OKAY).json((0,d.OF)({status:!0,data:a,message:"Interest status updated successfully"}))}catch(e){return console.error("Error updating user interest:",e),t.status(i.uT.INTERNAL_SERVER_ERROR).json((0,d.OF)({status:!1,message:"Failed to update user interest",error:e.message}))}},c=handler,R=(0,n.l)(r,"default"),p=(0,n.l)(r,"config"),E=new a.PagesAPIRouteModule({definition:{kind:u.x.PAGES_API,page:"/api/v1/user/interest",pathname:"/api/v1/user/interest",bundlePath:"",filename:""},userland:r})},3506:(e,t,s)=>{s.d(t,{D0:()=>r.D0,uD:()=>r.uD,xM:()=>r.xM});var r=s(7750)}};var t=require("../../../../webpack-api-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),s=t.X(0,[4222,5912,5166,9276,7750,3300],()=>__webpack_exec__(8874));module.exports=s})();