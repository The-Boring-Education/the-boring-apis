"use strict";(()=>{var e={};e.id=3354,e.ids=[3354],e.modules={8097:e=>{e.exports=require("@sentry/nextjs")},2167:e=>{e.exports=require("axios")},3582:e=>{e.exports=require("cors")},1185:e=>{e.exports=require("mongoose")},1649:e=>{e.exports=require("next-auth/react")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},3160:e=>{e.exports=require("next/dist/lib/import-next-warning")},5828:e=>{e.exports=require("uuid")},6113:e=>{e.exports=require("crypto")},7147:e=>{e.exports=require("fs")},1017:e=>{e.exports=require("path")},1711:(e,r,s)=>{s.r(r),s.d(r,{config:()=>p,default:()=>c,routeModule:()=>E});var t={};s.r(t),s.d(t,{default:()=>g});var a=s(1802),u=s(7153),n=s(6249),o=s(5912),i=s(3300),d=s(5166),l=s(3506);let handler=async(e,r)=>{await (0,d.D0)(e,r),await (0,l.uD)();let{method:s}=e,{userId:t,userName:a}=e.query;switch(s){case"GET":return getUserByUsername(e,r,a);case"POST":return handleUserOnboarding(e,r,t);case"PUT":return handlePrepYatraOnboarding(e,r,t);default:return r.status(o.uT.BAD_REQUEST).json((0,d.OF)({status:!1,message:`Method ${s} Not Allowed`}))}},getUserByUsername=async(e,r,s)=>{if(!s)return r.status(o.uT.BAD_REQUEST).json((0,d.OF)({status:!1,message:"Username is required"}));try{let{data:e,error:t}=await (0,i.getUserByUserNameFromDB)(s);if(t)return r.status(o.uT.OKAY).json((0,d.OF)({status:!1,message:"Username already taken. Please choose another."}));return r.status(o.uT.OKAY).json((0,d.OF)({status:!0,data:e,message:"Username is available."}))}catch(e){return r.status(o.uT.INTERNAL_SERVER_ERROR).json((0,d.OF)({status:!1,message:"Error while checking userName",error:e}))}},handleUserOnboarding=async(e,r,s)=>{try{let{userName:t,occupation:a,purpose:u,contactNo:n,from:l}=e.body;if(!s||!t||!a||!u||!n)return r.status(o.uT.BAD_REQUEST).json((0,d.OF)({status:!1,error:"Missing required fields",message:"Please provide all required fields"}));let{data:g,error:c}=await (0,i.onboardUserToDB)(s,t,a,u,n,l);if(c)return r.status(o.uT.BAD_REQUEST).json((0,d.OF)({status:!1,error:c,message:"Error while onboarding user"}));return r.status(o.uT.OKAY).json((0,d.OF)({status:!0,data:g,message:"User onboarded successfully"}))}catch(e){return r.status(o.uT.INTERNAL_SERVER_ERROR).json((0,d.OF)({status:!1,error:e,message:"Error while onboarding user"}))}},handlePrepYatraOnboarding=async(e,r,s)=>{try{let{workDomain:t,linkedInUrl:a,from:u}=e.body;if(!s||!t)return r.status(o.uT.BAD_REQUEST).json((0,d.OF)({status:!1,error:"Missing required fields",message:"Please provide all required fields"}));let{data:n,error:l}=await (0,i.onboardPrepYatraUserTODB)(s,t,a,u);if(l)return r.status(o.uT.BAD_REQUEST).json((0,d.OF)({status:!1,error:l,message:"Error while onboarding user"}));return r.status(o.uT.OKAY).json((0,d.OF)({status:!0,data:n,message:"User onboarded successfully"}))}catch(e){return r.status(o.uT.INTERNAL_SERVER_ERROR).json((0,d.OF)({status:!1,error:e,message:"Error while onboarding user"}))}},g=handler,c=(0,n.l)(t,"default"),p=(0,n.l)(t,"config"),E=new a.PagesAPIRouteModule({definition:{kind:u.x.PAGES_API,page:"/api/v1/user/onboarding",pathname:"/api/v1/user/onboarding",bundlePath:"",filename:""},userland:t})},3506:(e,r,s)=>{s.d(r,{D0:()=>t.D0,uD:()=>t.uD,xM:()=>t.xM});var t=s(7750)}};var r=require("../../../../webpack-api-runtime.js");r.C(e);var __webpack_exec__=e=>r(r.s=e),s=r.X(0,[4222,5912,5166,9276,7750,3300],()=>__webpack_exec__(1711));module.exports=s})();