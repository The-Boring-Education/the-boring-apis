"use strict";(()=>{var e={};e.id=8784,e.ids=[8784],e.modules={8097:e=>{e.exports=require("@sentry/nextjs")},2167:e=>{e.exports=require("axios")},3582:e=>{e.exports=require("cors")},1185:e=>{e.exports=require("mongoose")},1649:e=>{e.exports=require("next-auth/react")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},3160:e=>{e.exports=require("next/dist/lib/import-next-warning")},5828:e=>{e.exports=require("uuid")},6113:e=>{e.exports=require("crypto")},7147:e=>{e.exports=require("fs")},1017:e=>{e.exports=require("path")},9828:(e,t,r)=>{r.r(t),r.d(t,{config:()=>x,default:()=>c,routeModule:()=>y});var a={};r.r(a),r.d(a,{default:()=>p});var s=r(1802),i=r(7153),l=r(6249),o=r(5912),u=r(3300),d=r(5166),n=r(3506);let handler=async(e,t)=>{await (0,n.uD)();let{query:r}=e,{userId:a}=r;return"POST"===e.method?handleAddBulkPlaylist(e,t,a):t.status(o.uT.BAD_REQUEST).json({success:!1,message:`Method ${e.method} not allowed`})},handleAddBulkPlaylist=async(e,t,r)=>{let{playlists:a}=e.body;if(!Array.isArray(a)||0===a.length)return t.status(o.uT.BAD_REQUEST).json({success:!1,message:"No playlists provided"});let s=[],i=[];for(let e of a){let{playlistUrl:t,tags:a}=e,l=(0,d.iH)(t);if(!l){i.push({playlistUrl:t,error:"Invalid playlist URL"});continue}let{data:o}=await (0,u.checkPlaylistExistsByID)(l);if(o){r&&await (0,u.addUserPlaylistToDB)(r,o._id),await (0,u.updateReferredByInPlaylist)(o._id,!0),a&&await (0,u.updateTagsInPlaylist)(o._id,a),s.push(o);continue}try{let e=await (0,d.M2)(l);if(!e){i.push({playlistUrl:t,error:"Failed to fetch playlist from YouTube"});continue}let{error:o,data:n}=await (0,u.addPlaylistToDB)({...e,tags:a});if(o){i.push({playlistUrl:t,error:"Failed to add playlist to DB"});continue}if(r){let{error:e}=await (0,u.addUserPlaylistToDB)(r,n._id);if(e){i.push({playlistUrl:t,error:"Failed to link user and playlist"});continue}}s.push(n)}catch(e){i.push({playlistUrl:t,error:`Unexpected error: ${e}`})}}return t.status(o.uT.OKAY).json((0,d.OF)({status:!0,message:`Bulk playlist processing completed: ${s.length} added, ${i.length} failed`,data:{addedPlaylists:s,failedPlaylists:i}}))},p=handler,c=(0,l.l)(a,"default"),x=(0,l.l)(a,"config"),y=new s.PagesAPIRouteModule({definition:{kind:i.x.PAGES_API,page:"/api/v1/youfocus/bulk",pathname:"/api/v1/youfocus/bulk",bundlePath:"",filename:""},userland:a})},3506:(e,t,r)=>{r.d(t,{D0:()=>a.D0,uD:()=>a.uD,xM:()=>a.xM});var a=r(7750)}};var t=require("../../../../webpack-api-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),r=t.X(0,[4222,5912,5166,9276,7750,3300],()=>__webpack_exec__(9828));module.exports=r})();