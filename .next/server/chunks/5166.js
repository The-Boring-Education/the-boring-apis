"use strict";exports.id=5166,exports.ids=[5166],exports.modules={5166:(e,t,r)=>{r.d(t,{n1:()=>buildOrderPayload,oU:()=>calculateUserPointsForAction,V2:()=>captureAPIError,j5:()=>captureAuthError,dy:()=>cleanJobSkillsData,vO:()=>connectToDatabase,O6:()=>constrainNumberToRange,D0:()=>o,uZ:()=>createCashfreeOrder,vl:()=>createObjectId,M:()=>disconnectFromDatabase,iH:()=>extractPlaylistId,M2:()=>fetchPlaylistData,SM:()=>generatePaymentOrderId,NI:()=>generateSitemap,QY:()=>getMDXContent,FF:()=>getPYSubscriptionFeaturesByType,Si:()=>isProgramActive,Bk:()=>normalizeAPIPayload,OF:()=>sendAPIResponse,yL:()=>validateWebhookEvent,po:()=>verifyWebhookSignature});try{let e=r(3160),t=r(1649);e.NextApiRequest,t.getSession}catch(e){}var a,i=r(3582),n=r.n(i);try{let e=r(3160);e.NextApiRequest,e.NextApiResponse}catch(e){}let o=(a=n()({origin:"*",methods:["GET","POST","PUT","DELETE","PATCH","OPTIONS"],credentials:!1,allowedHeaders:["Content-Type","Authorization","x-admin-secret","cache"]}),(e,t)=>new Promise((r,i)=>{a(e,t,e=>e instanceof Error?i(e):r(e))}));var s=r(6113),l=r.n(s),c=r(5912);let sendAPIResponse=({success:e,status:t,error:r,message:a,data:i})=>({success:e,status:t,error:r,message:a,data:i}),calculateUserPointsForAction=e=>{let t=c.Rx[e]||0;return t},constrainNumberToRange=(e,t,r)=>Math.min(Math.max(e,t),r),isProgramActive=e=>new Date(e)<=new Date,generatePaymentOrderId=()=>`order_${Date.now()}_${Math.random().toString(36).substring(2,15)}`,buildOrderPayload=({orderId:e,amount:t,userId:r,customerName:a,customerEmail:i})=>({order_id:e,order_amount:t,order_currency:"INR",customer_details:{customer_id:r,customer_name:a,customer_email:i,customer_phone:"0000000000"},order_meta:{return_url:`${c._c.PLATFORM_URL}/payment/status?order_id=${e}`}}),createCashfreeOrder=async e=>{let t=c._c.CASHFREE_CLIENT_ID,r=c._c.CASHFREE_SECRET_KEY;if(!t||!r)throw Error("Cashfree credentials not configured");let a=await fetch(`${c._c.CASHFREE_BASE_URL}/orders`,{method:"POST",headers:{"Content-Type":"application/json","x-client-id":t,"x-client-secret":r,"x-api-version":"2022-09-01"},body:JSON.stringify(e)}),i=await a.json();return{data:i,ok:a.ok}},verifyWebhookSignature=(e,t,r)=>{if(!t)return{isValid:!1,error:"Missing webhook signature"};let a=l().createHmac("sha256",r).update(e).digest("base64");return{isValid:t===a}},validateWebhookEvent=e=>{let{order_id:t,payment_status:r}=e;return t&&"string"==typeof r?{isValid:!0,data:e}:{isValid:!1,error:"Missing order_id or invalid isPaid status in webhook payload"}},getPYSubscriptionFeaturesByType=e=>{let t=c.Ir.filter(e=>!["ColdEmailAutomation","LinkedInAutomation"].includes(e));return"Lifetime"===e?c.Ir:t},cleanJobSkillsData=e=>e.map(e=>e.trim().toLowerCase()).filter(e=>!c.Ps.includes(e)).map(e=>{let t=c.Jq.find(({label:t})=>t.includes(e));return t?t.value:e}),normalizeAPIPayload=(e,t)=>{let findNormalized=e=>{let r=e.trim().toLowerCase();for(let e of t)if(e.label.some(e=>e.toLowerCase()===r))return e.value;return e};return Array.isArray(e)?e.map(findNormalized):findNormalized(e)},fetchPlaylistName=async e=>{try{let t=await fetch(`${c.CL}/playlists?part=snippet&id=${e}&key=${c._c.YOUTUBE_API_KEY}`),r=await t.json();if(!t.ok)throw Error(`Failed to fetch playlist metadata: ${r.error?.message||"Unknown error"}`);if(0===r.items.length)throw Error("No playlist found with the given ID");let a=r.items[0].snippet;return{playlistName:a.title||"Unknown Playlist",description:a.description||"No Description Available",thumbnail:a.thumbnails?.maxres?.url||a.thumbnails?.standard?.url||a.thumbnails?.high?.url||a.thumbnails?.medium?.url||a.thumbnails?.default?.url||""}}catch(e){return console.error("Error fetching playlist name:",e),{}}},fetchPlaylistData=async(e,t="",r=[],a={})=>{try{if(!a.playlistName){let t=await fetchPlaylistName(e);a.playlistName=t.playlistName||"Unknown Playlist",a.description=t.description||"No Description Available",a.thumbnail=t.thumbnail||""}let i=await fetch(`${c.CL}/playlistItems?part=snippet&playlistId=${e}&maxResults=50&pageToken=${t}&key=${c._c.YOUTUBE_API_KEY}`),n=await i.json();if(!i.ok)throw Error(`Failed to fetch playlist data: ${n.error?.message||"Unknown error"}`);let o=n.items.map(e=>({title:e.snippet.title,videoId:e.snippet.resourceId.videoId,thumbnail:e.snippet.thumbnails?.default?.url||"https://via.placeholder.com/150"})),s=[...r,...o];if(n.nextPageToken)return fetchPlaylistData(e,n.nextPageToken,s,a);return{playlistId:e,playlistName:a.playlistName||"",description:a.description||"",thumbnail:a.thumbnail||"",videos:s}}catch(e){console.error("Error fetching playlist data:",e)}},extractPlaylistId=e=>{let t=e.match(/(?:list=|\/playlist\/)([a-zA-Z0-9_-]{10,})/);return t?t[1]:null};var d=r(7147),u=r.n(d),p=r(1017),m=r.n(p);let getMDXContent=(e="testing.md")=>{let t=m().join(process.cwd(),"src","utils","mdx",e),r=u().readFileSync(t,"utf8");return r};var h=r(1185),y=r.n(h);let f=!1,connectToDatabase=async()=>{if(f)return;let e=process.env.MONGODB_URI||process.env.MONGO_URI;if(!e)throw Error("MONGODB_URI or MONGO_URI environment variable is required");try{await y().connect(e),f=!0,console.log("Connected to MongoDB")}catch(e){throw console.error("MongoDB connection error:",e),e}},disconnectFromDatabase=async()=>{f&&(await y().disconnect(),f=!1,console.log("Disconnected from MongoDB"))},createObjectId=e=>e?new(y()).Types.ObjectId(e):new(y()).Types.ObjectId;var g=r(8097);let captureAPIError=(e,t,r,a,i)=>g.captureException(e,{tags:{section:"api",endpoint:t,method:r,status_code:a?.toString()||"unknown"},extra:{endpoint:t,method:r,statusCode:a,requestData:i},level:"error"}),captureAuthError=(e,t,r)=>g.captureException(e,{tags:{section:"authentication",auth_method:t},extra:{authMethod:t,userId:r},level:"warning"}),flattenRoutesForSitemap=e=>{let t=[];for(let r in e){if("api"===r||"internals"===r||"404"===r)continue;let a=e[r];"string"==typeof a?t.push(`https://theboringeducation.com${a}`):"object"==typeof a&&(t=t.concat(flattenRoutesForSitemap(a)))}return t},generateSitemap=()=>{let e=`<?xml version="1.0" encoding="UTF-8"?>
`;e+=`<urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9">
`;let t=flattenRoutesForSitemap(c._j);return t.forEach(t=>{e+=`<url><loc>${t}</loc></url>
`}),e+="</urlset>"}}};