"use strict";(()=>{var e={};e.id=7366,e.ids=[7366],e.modules={8097:e=>{e.exports=require("@sentry/nextjs")},2167:e=>{e.exports=require("axios")},3582:e=>{e.exports=require("cors")},1185:e=>{e.exports=require("mongoose")},1649:e=>{e.exports=require("next-auth/react")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},3160:e=>{e.exports=require("next/dist/lib/import-next-warning")},5828:e=>{e.exports=require("uuid")},6113:e=>{e.exports=require("crypto")},7147:e=>{e.exports=require("fs")},1017:e=>{e.exports=require("path")},7414:(e,t,s)=>{s.r(t),s.d(t,{config:()=>f,default:()=>p,routeModule:()=>q});var r={};s.r(r),s.d(r,{default:()=>c});var i=s(1802),n=s(7153),o=s(6249),u=s(1185),a=s(3300),d=s(5166),l=s(3506);async function handler(e,t){if(await (0,d.D0)(e,t),"POST"!==e.method)return t.status(405).json({error:"Method not allowed"});let{userId:s,quizId:r,difficulty:i="mixed",questionCount:n=10}=e.body;if(!s||!r)return t.status(400).json({error:"Missing required fields: userId, quizId"});if(i&&!["easy","medium","hard","mixed"].includes(i))return t.status(400).json({error:"Invalid difficulty. Must be easy, medium, hard, or mixed"});if(n<1||n>50)return t.status(400).json({error:"Question count must be between 1 and 50"});try{await (0,l.uD)();let e=await a.Quiz.findById(r).lean();if(!e||!e.isActive)return t.status(404).json({error:"Quiz not found or inactive"});if(!e.questions||0===e.questions.length)return t.status(400).json({error:"Quiz has no questions"});let o=e.questions;if("mixed"!==i&&(o=e.questions.filter(e=>e.difficulty===i)),o.length>n&&(o=o.slice(0,n)),0===o.length)return t.status(400).json({error:"No questions available for the selected difficulty"});let d={userId:new u.Types.ObjectId(s),quizId:new u.Types.ObjectId(r),categoryName:e.categoryName,difficulty:i,questionCount:o.length,questions:o.map(e=>({questionId:new u.Types.ObjectId,question:e.question,options:e.options,correctAnswer:e.correctAnswer,difficulty:e.difficulty,explanation:e.explanation,detailedExplanation:e.detailedExplanation})),status:"in_progress",startedAt:new Date},c=new a.QuizSession(d);await c.save();let p={sessionId:c._id,categoryName:c.categoryName,difficulty:c.difficulty,questionCount:c.questionCount,currentQuestionIndex:0,currentQuestion:c.questions[0]?{question:c.questions[0].question,options:c.questions[0].options,difficulty:c.questions[0].difficulty}:null,progress:{answered:0,total:c.questionCount,percentage:0}};t.status(201).json({success:!0,data:p})}catch(e){console.error("Error starting quiz session:",e),t.status(500).json({error:"Internal server error"})}}let c=handler,p=(0,o.l)(r,"default"),f=(0,o.l)(r,"config"),q=new i.PagesAPIRouteModule({definition:{kind:n.x.PAGES_API,page:"/api/v1/quiz/session/start",pathname:"/api/v1/quiz/session/start",bundlePath:"",filename:""},userland:r})},3506:(e,t,s)=>{s.d(t,{D0:()=>r.D0,uD:()=>r.uD,xM:()=>r.xM});var r=s(7750)}};var t=require("../../../../../webpack-api-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),s=t.X(0,[4222,5912,5166,9276,7750,3300],()=>__webpack_exec__(7414));module.exports=s})();